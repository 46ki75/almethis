---
import { createHighlighter } from 'shiki'

interface CodeBlockProps {
  code: string
  language?: string
}

const { code, language = 'plaintext' } = Astro.props as CodeBlockProps

const highlighter = await createHighlighter({
  langs: [language],
  themes: ['vitesse-light', 'vitesse-dark']
})

const html = highlighter.codeToHtml(code, {
  lang: language,
  themes: {
    dark: 'vitesse-dark',
    light: 'vitesse-light'
  },
  colorReplacements: {
    '#ffffff': 'transparent',
    '#121212': 'transparent'
  }
})
---

<div class='wrapper' set:html={html} />

<style scoped lang='scss'>
  .wrapper {
    margin: 0;
    padding: 0;
    font-size: 16px;
    line-height: 24px;
  }

  .shiki,
  .shiki span,
  pre {
    [data-theme='dark'] & {
      color: var(--shiki-dark) !important;
      background-color: var(--shiki-dark-bg) !important;
    }
  }
</style>
